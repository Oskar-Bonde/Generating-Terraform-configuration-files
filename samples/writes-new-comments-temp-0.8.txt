terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
    }
  }
}

# Provider block with AWS in us-east-1 region
# Also has a nested block, allowing us to test a provider with multiple
# nested blocks.
module "example" {
  source = "./test-fixtures/module-with-provider-and-nested"

  # This provider block imports a sub-module with a provider.
  providers = {
    aws = {
      region = "us-east-1"
    }
  }

  nested = {
    %s = {
      enabled = true
    }
  }
}

# Resource block with an EC2 instance called ec2demo with the t2.micro instance type and ami-0ff8a91507f77f867
resource "example_ec2" "ec2demo" {
  name = "ec2demo"

  security_groups = ["${example_vpc.vpc.id}"]

  depends_on = ["aws_internet_gateway.gw"]

  lifecycle {
    ignore_changes = ["tags", "security_groups"]
  }

  timeouts {
    create = "10m"
  }
}

