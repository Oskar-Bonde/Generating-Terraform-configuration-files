terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
    }
  }
}

# Provider Block, region set to us east 1 and default profile
provider "aws" {
  region     = "us-east-1"
  profile    = "default"
}

# Resource, an aws security group with the following ingress ports: 80, 443, 8080, 8081, 7080, 708
resource "aws_security_group" "web" {
  name        = "terraform_acceptance_test_example"
  description = "Used in the terraform acceptance tests"

  ingress {
    from_port       = 80
    to_port         = 80
    protocol        = "tcp"
    cidr_blocks     = ["10.0.0.0/8"]
  }

  ingress {
    from_port       = 443
    to_port         = 443
    protocol        = "tcp"
    cidr_blocks     = ["10.0.0.0/8"]
  }

  ingress {
    from_port       = 8080
    to_port         = 8080
    protocol        = "tcp"
    cidr_blocks     = ["10.0.0.0/8"]
  }

  ingress {
    from_port       = 8081
    to_port         = 8081
    protocol        = "tcp"
    cidr_blocks     = ["10.0.0.0/8"]
  }

  ingress {
    from_port       = 7080
    to_port         = 7080
    protocol        = "tcp"
    security_groups = ["${aws_security_group.other.id}"]
  }

  ingress {
    from_port       = 708
    to_port         = 708
    protocol        = "tcp"
    security_groups = ["${aws_security_group.other.id}"]
  }
}

