# raw-data/hashicorp-certified-terraform\10-Terraform-Modules\10-02-Terraform-Build-a-Module\v3-build-a-module-to-host-static-website-on-aws-s3
# Terraform Block with AWS
terraform {
  required_version = "~> 0.14"
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 3.0"
    }
  }
}

# Provider Block AWS with region var.aws_region and default profile
provider "aws" {
  region  = var.aws_region
  profile = "default"
}

# Create Variable for S3 Bucket Name called my_s3_bucket
variable "my_s3_bucket" {
  type = string
  default = "mybucket-1047"
}

## Create Variable for S3 Bucket Tags
variable "my_s3_tags" {
  description = "Tags to set on the bucket"
  type = map(string)
  default = {
    Terraform = "true"
    Environment = "dev"
    newtag1 = "tag1"
    newtag2 = "tag2"
  }
}


# Call Custom Terraform Module located in ./modules/aws-s3-static-website-bucket
module "website_s3_bucket" {
  source = "./modules/aws-s3-static-website-bucket"  # Mandatory
  bucket_name = var.my_s3_bucket
  tags = var.my_s3_tags
}

# Output block: ARN of the S3 Bucket
output "arn" {
  value       = aws_s3_bucket.s3_bucket.arn
}

# Output block: Name (id) of the bucket
output "name" {
  value       = aws_s3_bucket.s3_bucket.id
}

# Output block: Domain Name of the bucket
output "domain" {
  value       = aws_s3_bucket.s3_bucket.website_domain
}

# Output block: Endpoint Information of the bucket
output "endpoint" {
  value       = aws_s3_bucket.s3_bucket.website_endpoint
}
